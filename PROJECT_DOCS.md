GW2 Director Pro（Qt 版）项目说明文档

本文档是 GW2 Director Pro 项目的唯一权威说明文档。

目标读者：

未来的你

接手该项目的开发者 / AI

阅读本文件后，应当能够：

理解整个项目的设计动机

明确每一个文件“为什么存在”

知道未来功能应当往哪里扩展，而不是随意堆代码

一、项目概述

1.1 项目名称

GW2 Director Pro（Qt 版）

1.2 项目定位

Windows 桌面端工具

面向《激战 2（Guild Wars 2）》的 非侵入式自动化辅助系统

不读取游戏内存、不注入、不 Hook

仅通过：

屏幕像素采样

键盘输入模拟

实现技能释放自动化与研究。

1.3 核心目标

把“技能循环”当作一个可建模、可解释、可扩展的系统，而不是黑盒宏。

二、总体架构设计

2.1 架构分层原则（最重要）

整个项目严格分为三层：

入口层（app.py）
   ↓
UI 层（ui/）   ←――― 只展示，不判断
   ↓
Core 层（core/）←――― 只判断，不显示

2.2 核心设计铁律

Core 层永远不 import PySide6

UI 层永远不直接判断技能是否可释放

所有状态判断都来自 Engine

UI 只显示“结果”，不制造“规则”

这保证了：

架构长期稳定

UI 可随意重写

核心逻辑可测试、可复用

三、目录结构总览

GW2_Pro_Qt/
│  app.py
│  config.json
│
├─core/
│  │  __init__.py
│  │  config.py
│  │
│  ├─engine/
│  │  │  __init__.py
│  │  │  engine.py
│  │  │  evaluator.py
│  │  │  calibration.py
│  │
│  └─models/
│     │  __init__.py
│     │  skill.py
│     │  condition.py
│
└─ui/
   │  __init__.py
   │  constants.py
   │  main_window.py
   │  overlay.py
   │
   ├─panels/
   │     __init__.py
   │     skill_list.py
   │
   └─widgets/
         __init__.py
         skill_card.py
         skill_editor.py

四、根目录文件说明

4.1 app.py ―― 程序入口

职责：

创建 QApplication

设置全局字体（微软雅黑）

创建并显示主窗口

作为 PyInstaller 的唯一入口点

设计约定：

不写任何业务逻辑

不写 UI 布局细节

只做“启动与连接”

4.2 config.json ―― 用户配置文件

职责：

持久化存储所有用户数据

全局校准坐标

Profile 与技能列表

重要说明：

即使为空，也必须存在

所有配置修改最终都应写回此文件

五、Core 层详解（core/）

Core 层是整个系统的“规则制定者”。

5.1 core/config.py ―― 配置读写模块

职责：

从 config.json 读取配置

将内存中的数据保存回磁盘

设计目的：

将“配置格式”与“业务逻辑”解耦

为未来更换存储方案（数据库 / 云）预留空间

六、模型层（core/models/）

6.1 skill.py ―― 技能模型（核心模型）

定义内容：

技能的静态属性（名称、按键、延迟、校准坐标）

技能的运行状态（READY / 冷却 / 不可用）

关键设计思想：

技能 = 静态配置 + 动态运行态

UI 永远只读取 runtime，不自己判断。

6.2 condition.py ―― 条件系统模型（未来扩展核心）

职责：

描述“技能在什么条件下允许释放”

当前阶段：

只定义数据结构

不直接接 UI

不直接参与执行

未来扩展方向：

HP 条件

Buff 条件

技能联动条件

插件式条件系统

七、引擎层（core/engine/）

7.1 evaluator.py ―― 技能状态评估器

职责：

基于屏幕像素判断技能当前状态

返回明确状态：

READY（可释放）

COOLDOWN（冷却中）

FAIL（不可用）

设计原则：

单一职责

可独立测试

7.2 calibration.py ―― 校准系统

职责：

实现 6 点校准流程

计算技能图标中心点与 11 点方向采样点

设计原则：

只负责数学与坐标计算

不直接操作 UI

7.3 engine.py ―― 主引擎（系统心脏）

职责：

管理运行状态（启动 / 停止）

调度技能循环

调用 evaluator 判断技能

触发键盘输入

通知 UI 刷新显示

重要约定：

唯一允许“执行行为”的模块

不直接操作任何 UI 控件

八、UI 层详解（ui/）

UI 层是 Core 状态的“可视化投影”。

8.1 constants.py ―― UI 中文常量中心

职责：

管理所有中文文案

管理状态颜色映射

重要约定：

UI 文件中不允许硬编码文字

8.2 main_window.py ―― 主窗口

职责：

搭建整体布局

连接 Engine 与 UI

管理面板之间的交互

8.3 overlay.py ―― 悬浮状态窗

职责：

显示当前系统状态

提供即时运行反馈

九、UI 组件层

9.1 skill_card.py ―― 技能卡片

职责：

显示技能名称

显示技能状态（中文 + 颜色）

提供点击选择能力

9.2 skill_editor.py ―― 技能编辑面板

职责：

展示选中技能属性

为未来条件编辑器预留空间

十、给未来开发者的重要提示

不要把判断逻辑写进 UI

不要让 Engine 依赖 PySide6

新功能优先考虑是否属于：

模型层

引擎层

UI 层

如果你在犹豫放哪里，那说明你应该先扩展模型层。

十一、结语

GW2 Director Pro 的目标不是“自动打游戏”，而是：

用工程化方式，研究 MMO 技能系统的可编程性。

这份文档，是这个项目长期可维护性的基石。